---
phase: 01-schema-contracts
plan: 03
type: execute
wave: 2
depends_on:
  - "01-02"
files_modified:
  - skills/dsys/references/platform-specs/react-tailwind-spec.md
  - skills/dsys/references/platform-specs/swiftui-spec.md
autonomous: true
requirements:
  - ORCH-04

must_haves:
  truths:
    - "The React/Tailwind spec defines exactly which files the generator must produce"
    - "The SwiftUI spec defines exactly which files the generator must produce"
    - "The React/Tailwind spec specifies the Tailwind v4 @theme block with --color-*: initial reset"
    - "The SwiftUI spec specifies iOS 16 minimum target, @ScaledMetric spacing, and Color(named:) asset catalog pattern"
    - "Both specs include concrete file content examples that a generator agent can use as templates"
    - "Both specs list the required starter component templates (Button, Card, Input, Badge)"
  artifacts:
    - path: "skills/dsys/references/platform-specs/react-tailwind-spec.md"
      provides: "File manifest and content spec for React/Tailwind generator"
      contains: "@theme"
    - path: "skills/dsys/references/platform-specs/swiftui-spec.md"
      provides: "File manifest and content spec for SwiftUI generator"
      contains: "@ScaledMetric"
  key_links:
    - from: "skills/dsys/references/platform-specs/react-tailwind-spec.md"
      to: "skills/dsys/schemas/design-system.schema.json"
      via: "Generator reads design-system.json (validated by the schema) and produces these platform files"
      pattern: "design-system.json"
    - from: "skills/dsys/references/platform-specs/swiftui-spec.md"
      to: "skills/dsys/schemas/design-system.schema.json"
      via: "Generator reads design-system.json (validated by the schema) and produces these platform files"
      pattern: "design-system.json"
---

<objective>
Create the platform output specifications for React/Tailwind and SwiftUI generators, defining exactly which files each generator must produce, what goes in each file, and what "done" looks like with concrete examples.

Purpose: Without precise file manifests, generators will produce output that "looks right" but violates platform-specific requirements (e.g., Tailwind extending defaults instead of replacing them, SwiftUI using raw hex instead of asset catalogs). These specs prevent Pitfall 4 from the research: platform specs that underspecify the "done" condition.

Output: Two files in `skills/dsys/references/platform-specs/` — the React/Tailwind generator spec and the SwiftUI generator spec.
</objective>

<execution_context>
@/Users/james/.claude/get-shit-done/workflows/execute-plan.md
@/Users/james/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-schema-contracts/01-RESEARCH.md
@.planning/phases/01-schema-contracts/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create React/Tailwind platform output spec</name>
  <files>
    skills/dsys/references/platform-specs/react-tailwind-spec.md
  </files>
  <action>
Create `skills/dsys/references/platform-specs/react-tailwind-spec.md`.

Structure the document as follows:

1. **Overview**: This spec defines every file the React/Tailwind generator must produce when given a validated design-system.json. The generator reads `.dsys/design-system.json` and writes files into the target project.

2. **File Manifest** table:

| File | Purpose | Required |
|------|---------|----------|
| `tokens.json` | W3C DTCG source tokens | Yes |
| `tokens.css` | CSS custom properties (light + dark) | Yes |
| `theme.css` | Tailwind v4 `@theme` block | Yes |
| `components/Button.tsx` | Button component template | Yes |
| `components/Card.tsx` | Card component template | Yes |
| `components/Input.tsx` | Input component template | Yes |
| `components/Badge.tsx` | Badge component template | Yes |
| `components/Heading.tsx` | Heading component template | Yes |
| `components/Text.tsx` | Text component template | Yes |

3. **`tokens.json` Spec**: W3C DTCG format file. This is a direct transformation of `design-system.json` tokens into the DTCG file structure. Include both primitive and semantic layers. This file is the source of truth for Style Dictionary (if the user wants to run `npx style-dictionary build` later).

4. **`tokens.css` Spec**: CSS custom properties file. Must contain:
   - A `:root` block with all light-theme CSS variables using `--ds-` prefix (e.g., `--ds-color-action-primary: #3B82F6;`)
   - A `@media (prefers-color-scheme: dark) { :root { ... } }` block with all dark-theme CSS variables
   - A `.dark` class selector block with the same dark-theme variables (for manual class-based theme switching)
   - Typography variables: `--ds-font-family-sans`, `--ds-font-family-mono`, `--ds-font-size-{tier}`
   - Spacing variables: `--ds-spacing-{N}`
   - Border radius variables: `--ds-radius-{tier}`
   - Shadow variables: `--ds-shadow-{tier}`
   - Include a complete example file showing the CSS structure.

5. **`theme.css` Spec**: Tailwind v4 theme configuration. Must contain:
   - `@import "tailwindcss";` at the top
   - `@theme { ... }` block that maps Tailwind namespace variables to `--ds-` CSS custom properties
   - **CRITICAL**: `--color-*: initial;` MUST be the first line inside `@theme` to reset all Tailwind default colors. Without this, the full default palette coexists with the design system palette, defeating enforcement.
   - Color mappings: `--color-primary: var(--ds-color-action-primary);` etc.
   - Font mappings: `--font-sans: var(--ds-font-family-sans);`
   - Type scale: `--text-{tier}: var(--ds-font-size-{tier});`
   - Spacing: `--spacing: 4px;` (uses Tailwind v4's single-value spacing scale)
   - Radius: `--radius-{tier}: var(--ds-radius-{tier});`
   - Include the complete example from the research document.

6. **Component Template Spec**: For each component (Button, Card, Input, Badge, Heading, Text):
   - Describe the component's purpose and variants
   - Specify that components use Tailwind classes referencing the design system tokens (e.g., `bg-primary text-inverse` not `bg-blue-500 text-white`)
   - Components must be TypeScript (.tsx), use React.forwardRef where applicable, accept className for composition
   - Include a concrete example for Button showing the expected output structure:
     ```tsx
     // Button.tsx — generated by dsys
     import { forwardRef } from "react";

     interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
       variant?: "primary" | "secondary" | "destructive";
       size?: "sm" | "md" | "lg";
     }

     const Button = forwardRef<HTMLButtonElement, ButtonProps>(
       ({ variant = "primary", size = "md", className, children, ...props }, ref) => {
         const variants = {
           primary: "bg-primary text-inverse hover:bg-primary/90",
           secondary: "bg-surface-raised text-primary border border-border hover:bg-surface-raised/90",
           destructive: "bg-destructive text-inverse hover:bg-destructive/90",
         };
         const sizes = {
           sm: "px-3 py-1.5 text-sm rounded-sm",
           md: "px-4 py-2 text-base rounded-md",
           lg: "px-6 py-3 text-lg rounded-lg",
         };
         return (
           <button ref={ref} className={`${variants[variant]} ${sizes[size]} font-medium ${className ?? ""}`} {...props}>
             {children}
           </button>
         );
       }
     );
     Button.displayName = "Button";
     export default Button;
     ```

7. **Naming Conventions** section:
   - CSS variable prefix: `--ds-`
   - Tailwind token names: kebab-case (primary, surface-raised, text-muted)
   - Component files: PascalCase.tsx
   - No index.ts barrel exports (keep it simple for v1)

8. **"Done" Checklist**: The generator output is complete when:
   - [ ] `tokens.json` is valid DTCG JSON
   - [ ] `tokens.css` has both `:root` (light) and `.dark` / `@media prefers-color-scheme` (dark) blocks
   - [ ] `theme.css` starts with `@import "tailwindcss"` and has `--color-*: initial;` reset
   - [ ] All 6 component files exist and use only design system Tailwind classes (no raw colors, no raw pixel values)
   - [ ] A developer can copy these files into a Tailwind v4 project and use them immediately
  </action>
  <verify>
    The file exists and contains all 8 sections. The theme.css example includes `--color-*: initial;`. The Button example uses design system token names (bg-primary, text-inverse) not raw values. The file manifest table lists all 9 files.
  </verify>
  <done>
    The React/Tailwind platform spec defines every file the generator must produce, with concrete examples showing expected content structure, Tailwind v4 theme reset pattern, and component template patterns using design system tokens.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SwiftUI platform output spec</name>
  <files>
    skills/dsys/references/platform-specs/swiftui-spec.md
  </files>
  <action>
Create `skills/dsys/references/platform-specs/swiftui-spec.md`.

Structure the document as follows:

1. **Overview**: This spec defines every file the SwiftUI generator must produce. Minimum iOS target: **iOS 16**. The generator reads `.dsys/design-system.json` and writes files into the target project.

2. **File Manifest** table:

| File | Purpose | Required |
|------|---------|----------|
| `DesignSystem/Colors+DesignSystem.swift` | Color token extensions | Yes |
| `DesignSystem/Typography+DesignSystem.swift` | Font/Typography extensions | Yes |
| `DesignSystem/Spacing+DesignSystem.swift` | Spacing constants with @ScaledMetric | Yes |
| `DesignSystem/Radius+DesignSystem.swift` | Border radius constants | Yes |
| `DesignSystem/Shadows+DesignSystem.swift` | Shadow style extensions | Yes |
| `DesignSystem/Colors.xcassets/` | Asset catalog with color sets | Yes |
| `DesignSystem/Components/DSButton.swift` | Button component | Yes |
| `DesignSystem/Components/DSCard.swift` | Card component | Yes |
| `DesignSystem/Components/DSInput.swift` | Input/TextField component | Yes |
| `DesignSystem/Components/DSBadge.swift` | Badge component | Yes |
| `DesignSystem/Components/DSHeading.swift` | Heading text component | Yes |
| `DesignSystem/Components/DSText.swift` | Body text component | Yes |

3. **`Colors+DesignSystem.swift` Spec**:
   - Public extension on `Color` with static properties for each semantic color token
   - Use `Color("tokenName", bundle: .module)` pattern — NOT `Color(hex:)` custom initializer
   - The `bundle: .module` parameter references the asset catalog in the same Swift package/module
   - Token names use `ds` prefix with camelCase: `dsActionPrimary`, `dsSurfaceDefault`, `dsTextPrimary`, etc.
   - Include the complete example from the research document.

4. **`Colors.xcassets/` Spec**:
   - One `.colorset` directory per semantic color token
   - Each colorset has a `Contents.json` with two entries: universal (light) and dark appearance
   - Color values in sRGB color space with red/green/blue/alpha as decimal strings (0.000 to 1.000)
   - Include the complete Contents.json example from the research document
   - Directory structure: `Colors.xcassets/{tokenName}.colorset/Contents.json`

5. **`Typography+DesignSystem.swift` Spec**:
   - Struct or extension providing font access: `DSFont.heading1`, `DSFont.body`, `DSFont.caption`, etc.
   - Use `.font(.custom("FontName", size: N))` for custom fonts
   - Provide a `.system` fallback for each tier using the appropriate `Font.TextStyle`
   - Include `@ScaledMetric` for font sizes that should respect Dynamic Type
   - Example:
     ```swift
     public struct DSFont {
         public static func heading1() -> Font {
             .custom("Inter", size: 32, relativeTo: .largeTitle)
         }
         public static func body() -> Font {
             .custom("Inter", size: 16, relativeTo: .body)
         }
     }
     ```

6. **`Spacing+DesignSystem.swift` Spec**:
   - Use `@ScaledMetric` for Dynamic Type-aware spacing
   - Note: `@ScaledMetric` requires instance properties, not static. Provide a struct pattern:
     ```swift
     public struct DSSpacing {
         @ScaledMetric(relativeTo: .body) public var xs: CGFloat = 4
         @ScaledMetric(relativeTo: .body) public var sm: CGFloat = 8
         @ScaledMetric(relativeTo: .body) public var md: CGFloat = 16
         @ScaledMetric(relativeTo: .body) public var lg: CGFloat = 24
         @ScaledMetric(relativeTo: .body) public var xl: CGFloat = 32
         @ScaledMetric(relativeTo: .body) public var xxl: CGFloat = 48

         public init() {}
     }
     ```
   - Provide a global instance or `@Environment` wrapper for convenient access

7. **`Radius+DesignSystem.swift` Spec**:
   - Simple struct with static CGFloat properties
   - `DSRadius.sm`, `DSRadius.md`, `DSRadius.lg`, `DSRadius.full`

8. **`Shadows+DesignSystem.swift` Spec**:
   - ViewModifier pattern for shadow application
   - Example: `.modifier(DSShadow.md)` or `.dsShadow(.md)` via a View extension

9. **Component Template Spec**: For each component (DSButton, DSCard, DSInput, DSBadge, DSHeading, DSText):
   - Describe the component's purpose and variants
   - Components use design system tokens exclusively (Color.dsActionPrimary, DSSpacing, DSFont, DSRadius)
   - Components must include `#Preview` blocks for Xcode canvas preview
   - Component names prefixed with `DS` to avoid conflicts with SwiftUI built-in views
   - Include a concrete example for DSButton:
     ```swift
     public struct DSButton: View {
         public enum Variant { case primary, secondary, destructive }
         public enum Size { case sm, md, lg }

         let title: String
         let variant: Variant
         let size: Size
         let action: () -> Void

         public init(_ title: String, variant: Variant = .primary, size: Size = .md, action: @escaping () -> Void) {
             self.title = title
             self.variant = variant
             self.size = size
             self.action = action
         }

         public var body: some View {
             Button(action: action) {
                 Text(title)
                     .font(fontSize)
                     .fontWeight(.medium)
                     .padding(.horizontal, horizontalPadding)
                     .padding(.vertical, verticalPadding)
             }
             .foregroundStyle(foregroundColor)
             .background(backgroundColor)
             .clipShape(RoundedRectangle(cornerRadius: cornerRadius))
         }

         // Private computed properties for variant/size resolution...
     }

     #Preview {
         VStack(spacing: 16) {
             DSButton("Primary") {}
             DSButton("Secondary", variant: .secondary) {}
             DSButton("Destructive", variant: .destructive) {}
         }
         .padding()
     }
     ```

10. **Naming Conventions** section:
    - Color extensions: `ds` + PascalCase role (`dsActionPrimary`, `dsSurfaceDefault`)
    - Structs: `DS` prefix (`DSSpacing`, `DSFont`, `DSRadius`)
    - Components: `DS` prefix (`DSButton`, `DSCard`)
    - Asset catalog colorsets: camelCase matching the Color extension name

11. **"Done" Checklist**: The generator output is complete when:
    - [ ] All `.swift` files compile against iOS 16 (no iOS 17+ APIs)
    - [ ] Colors reference asset catalog via `Color("name", bundle: .module)` — no raw hex initializers
    - [ ] Spacing uses `@ScaledMetric` for Dynamic Type support
    - [ ] All 6 component files include `#Preview` blocks
    - [ ] Asset catalog has a `.colorset` for every semantic color token with light + dark variants
    - [ ] A developer can drop the `DesignSystem/` folder into an Xcode project and use it immediately
  </action>
  <verify>
    The file exists and contains all 11 sections. The Colors spec uses `Color("name", bundle: .module)` pattern. The Spacing spec uses `@ScaledMetric`. The DSButton example includes a `#Preview` block. The file manifest table lists all 12 entries. The minimum iOS target is specified as iOS 16.
  </verify>
  <done>
    The SwiftUI platform spec defines every file the generator must produce, with concrete examples showing expected content structure, asset catalog format, @ScaledMetric spacing, Color(named:) pattern, and component templates with #Preview blocks.
  </done>
</task>

</tasks>

<verification>
1. Both platform spec files exist under `skills/dsys/references/platform-specs/`
2. React/Tailwind spec includes `--color-*: initial;` reset in the theme.css example
3. SwiftUI spec specifies iOS 16 minimum target
4. Both specs include file manifests listing every required output file
5. Both specs include "Done" checklists with objective pass/fail criteria
6. Both specs include concrete code examples for at least the Button component
7. Both specs reference `design-system.json` as the input source
</verification>

<success_criteria>
- Both platform specs define exact file manifests — no ambiguity about which files to generate
- The React/Tailwind spec enforces the Tailwind v4 `@theme` reset pattern and uses design system token names in components
- The SwiftUI spec enforces asset catalog colors, @ScaledMetric spacing, and #Preview blocks
- Both specs include enough concrete examples that a generator agent can produce conformant output without interpretation
- Both specs include "Done" checklists that are objectively verifiable
</success_criteria>

<output>
After completion, create `.planning/phases/01-schema-contracts/01-03-SUMMARY.md`
</output>
